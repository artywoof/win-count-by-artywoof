<!DOCTYPE html>
<html>
<head>
    <title>BroadcastChannel Debug</title>
    <style>
        body { font-family: Arial; padding: 20px; background: white; }
        .log { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 5px; }
        button { padding: 10px; margin: 5px; font-size: 16px; }
    </style>
</head>
<body>
    <h1>BroadcastChannel Debug Tool</h1>
    
    <div>
        <button onclick="sendTestData()">Send Test Data</button>
        <button onclick="clearLog()">Clear Log</button>
    </div>
    
    <h3>Send Manual Data:</h3>
    <input type="number" id="winInput" value="77" placeholder="Win">
    <input type="number" id="goalInput" value="99" placeholder="Goal">
    <button onclick="sendManualData()">Send Manual</button>
    
    <div id="log"></div>

    <script>
        const channel = new BroadcastChannel('win-count-overlay');
        const log = document.getElementById('log');
        
        function addLog(message) {
            const div = document.createElement('div');
            div.className = 'log';
            div.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.insertBefore(div, log.firstChild);
        }
        
        channel.onmessage = (event) => {
            addLog(`ðŸ“¥ RECEIVED: ${JSON.stringify(event.data)}`);
        };
        
        function sendTestData() {
            const data = { win: 555, goal: 25, show_crown: true, show_goal: true };
            channel.postMessage(data);
            addLog(`ðŸ“¤ SENT: ${JSON.stringify(data)}`);
        }
        
        function sendManualData() {
            const win = parseInt(document.getElementById('winInput').value) || 0;
            const goal = parseInt(document.getElementById('goalInput').value) || 10;
            const data = { win, goal, show_crown: true, show_goal: true };
            channel.postMessage(data);
            addLog(`ðŸ“¤ SENT MANUAL: ${JSON.stringify(data)}`);
        }
        
        function clearLog() {
            log.innerHTML = '';
        }
        
        addLog('ðŸš€ BroadcastChannel debug tool ready');
        addLog('Channel name: win-count-overlay');
    </script>
</body>
</html>
