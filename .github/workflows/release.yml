# .github/workflows/release.yml
# à¸Šà¸±à¹ˆà¸§à¸„à¸£à¸²à¸§: à¸›à¸´à¸” auto-updater à¹€à¸žà¸·à¹ˆà¸­à¹ƒà¸«à¹‰ build à¸œà¹ˆà¸²à¸™à¸à¹ˆà¸­à¸™
name: ðŸš€ Release Win Count (No Auto-Update)

on:
  push:
    tags:
      - 'v*.*.*'

permissions:
  contents: write

jobs:
  build-and-release:
    runs-on: windows-latest
    
    steps:
      - name: ðŸ“‚ Checkout repository
        uses: actions/checkout@v4

      - name: ðŸŸ¢ Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: latest

      - name: ðŸ¦€ Install Rust
        uses: dtolnay/rust-toolchain@stable

      - name: ðŸ”§ Install dependencies
        run: bun install

      - name: ðŸ—ï¸ Build frontend
        run: bun run build:frontend

      - name: ðŸ·ï¸ Get version
        id: get_version
        shell: bash
        run: echo "VERSION=${GITHUB_REF#refs/tags/}" >> $GITHUB_OUTPUT

      - name: ðŸ“± Build Tauri app (No Updater)
        uses: tauri-apps/tauri-action@v0
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          tagName: ${{ steps.get_version.outputs.VERSION }}
          releaseName: 'Win Count ${{ steps.get_version.outputs.VERSION }}'
          releaseBody: |
            ## ðŸŽ‰ Win Count by ArtYWoof ${{ steps.get_version.outputs.VERSION }}
            
            ### âœ¨ Features:
            - Real-time win counter for TikTok Live streaming
            - Customizable hotkeys and presets
            - System tray integration
            - Overlay support for streaming software
            
            ### ðŸ“¥ Installation:
            1. Download the `.msi` file below
            2. Run as Administrator
            3. Follow the installation wizard
            4. Launch from Start Menu or Desktop shortcut
            
            ### ðŸŽ¯ How to Use:
            1. Set your win goal
            2. Use hotkeys to increase/decrease wins
            3. Copy overlay link for TikTok Live Studio
            4. Customize settings as needed
            
            ---
            
            **Note:** Auto-update will be enabled in future releases.
          releaseDraft: false
          prerelease: false
          includeUpdaterJson: false  # à¸›à¸´à¸” updater à¸Šà¸±à¹ˆà¸§à¸„à¸£à¸²à¸§

      - name: âœ… Release Summary
        run: |
          echo "ðŸŽ‰ Release ${{ steps.get_version.outputs.VERSION }} completed!"
          echo "ðŸ“¦ MSI installer created successfully"
          echo "ðŸ”— Download: https://github.com/${{ github.repository }}/releases/tag/${{ steps.get_version.outputs.VERSION }}"
          echo ""
          echo "ðŸ“‹ Next Steps:"
          echo "1. Test the MSI installer"
          echo "2. Setup minisign keys for auto-update"
          echo "3. Enable auto-update in future releases" 